<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:jsf="jakarta.faces"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:c="jakarta.tags.core"
      xmlns:f="jakarta.faces.core">
<ui:include src="static/header.xhtml"></ui:include>
<title>Główna</title>
<ui:include src="static/navigationMain.xhtml"></ui:include>

<body jsf:id="body">
<section jsf:id="section">
    <h1>Spotify Search</h1>

    <!-- Szukanie albumu   -->
    <form jsf:id="formSearchAlbum" class="search-tag-link">
        <input type="text" jsf:value="#{spotifyServiceFacelets.albumName}"/>
        <button class="btn" jsf:action="#{spotifyServiceFacelets.getAllAlbumsAfterSearch()}">Szukaj</button>
    </form>

    <!--Filtr ajax znalezionych albumów  -->
    <form jsf:id="searchAlbumKeyUp">
        <input type="text" jsf:id="searchAlbumInputKeyUp" jsf:value="#{spotifyServiceFacelets.searchAlbum}">

        </input>
    </form>

    <!--Znalezione albumy po wyszukiwaniu-->
    <div jsf:id="albums" class="box">
        <h:form>
            <h:selectOneRadio value="#{spotifyServiceFacelets.albumId}" class="box">
                <div class="box">
                    <f:selectItems value="#{spotifyServiceFacelets.filterAlbums()}" var="c"
                                   itemLabel="#{c.name()}" itemValue="#{c.id()}" class="element" />
                </div>
            </h:selectOneRadio>
            <h:commandButton value="Wybierz" action="#{spotifyServiceFacelets.getAlbumTracks()}"/>
        </h:form>
    </div>

    <!--Filtrowanie piosenek-->
    <form jsf:id="searchKeyUp">
        <input type="text" jsf:id="searchInputKeyUp" jsf:value="#{spotifyServiceFacelets.searchKeyUpText}">
            <f:ajax execute="searchInputKeyUp" render=":table searchInputKeyUp"
                    event="keyup" listener="#{spotifyServiceFacelets.filterTracks}"
                    delay="300"/>
        </input>
    </form>

    <!--   Tabela piosenek  -->
    <table jsf:id="table">
        <tr>
            <th>Track Number</th>
            <th>Title</th>
            <th>Duration</th>
        </tr>

        <ui:repeat value="#{spotifyServiceFacelets.filterTracks()}" var="track">
            <tr>
                <td>#{track.track_number()}</td>
                <td>#{track.name()}</td>
                <td>#{track.duration_ms()}</td>
            </tr>
        </ui:repeat>

    </table>

</section>
</body>

</html>